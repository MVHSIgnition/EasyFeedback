<html>
<body>
<h1 id="question" style ="visibility:hidden:"></h1>
<h1 id="data" style="visibility:hidden">Data</h1>
<button id="btn" onclick="startPoll()">Publish Next Question</button>

<p id="a" style="visibility:hidden">a: 0</p>
<p id="b" style="visibility:hidden">b: 0</p>
<p id="c" style="visibility:hidden">c: 0</p>
<p id="d" style="visibility:hidden">d: 0</p>
<button id="reset" onclick="resetAll()" style="visibility:hidden">Stop Polling</button>
</body>




</html>
<script src=http://cdn.pubnub.com/pubnub.min.js></script>
<script>
var qhtml = PUBNUB.$('question');
var anum = 0, bnum = 0, cnum =0, dnum = 0;
var stopvar = false;
var pubnub = PUBNUB.init({publish_key:'pub-c-afbd56e9-6341-4a07-b493-cbb3ebf25284',subscribe_key:'sub-c-d785fd74-f08e-11e6-9283-02ee2ddab7fe',ssl:true});
var a = PUBNUB.$('a'), b = PUBNUB.$('b'), c = PUBNUB.$('c'), d = PUBNUB.$('d'), button = PUBNUB.$('btn'),button2 = PUBNUB.$('reset'), data = PUBNUB.$('data');
function startPoll(){
	qhtml.style.visibility = "visible";
	a.style.visibility = "visible";
	b.style.visibility = "visible";
	c.style.visibility = "visible";
	d.style.visibility = "visible";
	button.style.visibility = "hidden";
	button2.style.visibility = "visible";


	var channels = ['t_handler','s_handler'];
	pubnub.subscribe({
		channel  : channels,
		callback : function(message) { 
			if(message[0] === 1){
				if(message[1] === 0){
					anum += 1;
					a.innerHTML = "a: "+anum;
				}
				else if(message[1] == 1){
					bnum += 1;
					b.innerHTML = "b: "+bnum;
				}
				else if(message[1] == 2){
					cnum += 1;
					c.innerHTML = "c: "+cnum;
				}
				else if(message[1] == 3){
					dnum += 1;
					d.innerHTML = "d: "+dnum;
				}
			}
			else if(message[0] === 0){
				console.log("hootis");
				qhtml.innerHTML = message[1];
			}
			else if(message[0] == 4){
				console.log("xd");
				stopvar = true;
			}
		}
	});
	pubnub.publish({
			channel : "s_handler", message : [0]
		})

	}
function resetAll(){
	pubnub.publish({
        channel : "s_handler", message : [3,qhtml.value,[anum,bnum,cnum,dnum]]
    })
	anum = 0, bnum = 0, cnum =0, dnum = 0;
	if(stopvar == false){
		qhtml.style.visibility = "hidden";
		a.style.visibility = "hidden";
		a.innerHTML = "a: 0";
		b.style.visibility = "hidden";
		b.innerHTML = "b: 0";
		c.style.visibility = "hidden";
		c.innerHTML = "c: 0";
		d.style.visibility = "hidden";
		d.innerHTML = "d: 0";
		button.style.visibility = "visible";
		button2.style.visibility = "hidden";
	}else{
		qhtml.style.visibility = "hidden";
		a.style.visibility = "hidden";
		a.innerHTML = "a: 0";
		b.style.visibility = "hidden";
		b.innerHTML = "b: 0";
		c.style.visibility = "hidden";
		c.innerHTML = "c: 0";
		d.style.visibility = "hidden";
		d.innerHTML = "d: 0";
		button.style.visibility = "hidden";
		button2.style.visibility = "hidden";
		data.style.visibility = "visible";
	}
}</script>
<script>

</script>

